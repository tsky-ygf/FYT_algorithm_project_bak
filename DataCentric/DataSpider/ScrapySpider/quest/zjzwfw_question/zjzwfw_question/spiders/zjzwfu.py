import copy
import hashlib

import scrapy
import logging
import json
from zjzwfw_question.items import ZjzwfwQuestionItem

key_dict = {'330102014': '上城区四季青街道', '330102017': '上城区丁兰街道', '330102001': '清波街道', '330102003': '湖滨街道',
            '330102004': '小营街道', '330102008': '南星街道', '330102009': '紫阳街道', '330102002': '上城区闸弄口街道',
            '330102006': '上城区采荷街道', '330102005': '上城区凯旋街道', '330102012': '上城区笕桥街道', '330102011': '上城区彭埠街道',
            '330102013': '上城区九堡街道', '330102018': '九堡街道', '330102010': '望江街道', '330102015': '彭埠街道', '330102016': '笕桥街道',
            '330102101': '望江街道', '330105007': '大关街道', '330105001': '米市巷街道', '330105002': '湖墅街道', '330105011': '半山街道',
            '330105003': '小河街道', '330105004': '和睦街道', '330105008': '上塘街道', '330105009': '祥符街道', '330105140': '拱墅区天水街道',
            '330105150': '拱墅区武林街道', '330105160': '拱墅区长庆街道', '330105170': '拱墅区朝晖街道', '330105180': '拱墅区文晖街道',
            '330105190': '拱墅区石桥街道', '330105200': '拱墅区潮鸣街道', '330105210': '拱墅区东新街道', '330105131': '康桥街道',
            '330105010': '康桥街道', '330105012': '天水街道', '330105013': '武林街道', '330105014': '长庆街道', '330105015': '潮鸣街道',
            '330105016': '朝晖街道', '330105017': '文晖街道', '330105018': '东新街道', '330105019': '石桥街道', '330105005': '拱宸桥街道',
            '330106013': '文新街道', '330106109': '三墩镇', '330106005': '翠苑街道', '330106011': '蒋村街道', '330106004': '西溪街道',
            '330106007': '古荡街道', '330106009': '留下街道', '330106012': '灵隐街道', '330106002': '北山街道', '330106015': '双浦镇',
            '330106008': '西湖街道', '330106014': '转塘街道', '330106010': '转塘街道', '330106110': '双浦镇', '330108002': '长河街道',
            '330108003': '浦沿街道', '330108001': '西兴街道', '330109501': '围垦区', '330109102': '戴村镇', '330109005': '靖江街道',
            '330109002': '北干街道', '330109004': '新塘街道', '330109001': '城厢街道', '330109113': '瓜沥镇', '330109006': '南阳街道',
            '330109105': '临浦镇', '330109003': '蜀山街道', '330109107': '所前镇', '330109103': '浦阳镇', '330109104': '进化镇',
            '330109106': '义桥镇', '330109108': '衙前镇', '330109109': '闻堰镇', '330109115': '益农镇', '330109111': '新街街道',
            '330109112': '盈丰街道', '330109131': '楼塔镇', '330109132': '党湾镇', '330109015': '盈丰街道', '330109012': '闻堰街道',
            '330109133': '宁围街道', '330109013': '宁围街道', '330109014': '新街街道', '330109100': '楼塔镇', '330109120': '党湾镇',
            '330109401': '萧山经济技术开发区', '330109403': '萧山商业城', '330109503': '红山农场', '330109505': '萧山钱江世纪城',
            '330109101': '河上镇', '330110010': '良渚街道', '330110102': '塘栖镇', '330110007': '运河街道', '330110002': '南苑街道',
            '330110004': '星桥街道', '330110024': '东湖街道', '330110109': '径山镇', '330110008': '崇贤街道', '330110014': '中泰街道',
            '330110005': '五常街道', '330110009': '仁和街道', '330110013': '余杭街道', '330110006': '乔司街道', '330110111': '鸬鸟镇',
            '330110112': '百丈镇', '330110113': '黄湖镇', '330110011': '闲林街道', '330110012': '仓前街道', '330110023': '临平街道',
            '330110003': '良渚街道', '330110020': '瓶窑镇', '330110110': '瓶窑镇', '330111211': '万市镇', '330111117': '大源镇',
            '330111001': '富春街道', '330111115': '新登镇', '330111101': '洞桥镇', '330111112': '龙门镇', '330111204': '环山乡',
            '330111109': '常绿镇', '330111105': '永昌镇', '330111004': '鹿山街道', '330111103': '渌渚镇', '330111118': '灵桥镇',
            '330111201': '上官乡', '330111207': '渔山乡', '330111205': '湖源乡', '330111212': '场口镇', '330111213': '新桐乡',
            '330111206': '春建乡', '330111116': '胥口镇', '330111002': '春江街道', '330111005': '东洲街道', '330111006': '银湖街道',
            '330111108': '里山镇', '330111111': '常安镇', '330111100': '万市镇', '330111110': '场口镇', '330111200': '新桐乡',
            '330112115': '板桥镇', '330112006': '锦城街道', '330112103': '太湖源镇', '330112104': '於潜镇', '330112106': '太阳镇',
            '330112002': '玲珑街道', '330112005': '锦南街道', '330112007': '锦北街道', '330112008': '青山湖街道', '330112102': '高虹镇',
            '330112107': '潜川镇', '330112108': '昌化镇', '330112109': '河桥镇', '330112111': '湍口镇', '330112112': '清凉峰镇',
            '330112113': '岛石镇', '330112116': '天目山镇', '330112117': '龙岗镇', '330113001': '运河街道', '330113004': '崇贤街道',
            '330113006': '南苑街道', '330113007': '星桥街道', '330113008': '东湖街道', '330113002': '乔司街道', '330113005': '临平街道',
            '330113003': '塘栖镇', '330113100': '塘栖镇', '330114007': '前进街道', '330114003': '河庄街道', '330114002': '白杨街道',
            '330114004': '义蓬街道', '330114006': '临江街道', '330114001': '下沙街道', '330114005': '新湾街道', '330122102': '横村镇',
            '330122004': '城南街道', '330122113': '江南镇', '330122202': '钟山乡', '330122002': '旧县街道', '330122005': '凤川街道',
            '330122101': '富春江镇', '330122109': '分水镇', '330122112': '百江镇', '330122204': '新合乡', '330122201': '莪山畲族乡',
            '330122003': '桐君街道', '330122131': '瑶琳镇', '330122132': '合村乡', '330122210': '合村乡', '330122110': '瑶琳镇',
            '330127100': '千岛湖镇', '330127107': '梓桐镇', '330127203': '左口乡', '330127212': '浪川乡', '330127202': '富文乡',
            '330127104': '威坪镇', '330127206': '瑶山乡', '330127101': '文昌镇', '330127102': '石林镇', '330127103': '临岐镇',
            '330127216': '安阳乡', '330127111': '枫树岭镇', '330127106': '姜家镇', '330127108': '汾口镇', '330127109': '中洲镇',
            '330127201': '金峰乡', '330127205': '屏门乡', '330127208': '王阜乡', '330127211': '鸠坑乡', '330127214': '界首乡',
            '330127132': '大墅镇', '330127131': '宋村乡', '330127110': '大墅镇', '330127210': '宋村乡', '330127200': '里商乡',
            '330182110': '航头镇', '330182003': '更楼街道', '330182111': '大慈岩镇', '330182002': '洋溪街道', '330182104': '梅城镇',
            '330182105': '杨村桥镇', '330182106': '下涯镇', '330182108': '三都镇', '330182109': '寿昌镇', '330182112': '大同镇',
            '330182101': '莲花镇', '330182107': '大洋镇', '330182102': '乾潭镇', '330182202': '钦堂乡', '330182113': '李家镇',
            '330182001': '新安江街道', '330198008': '西湖街道', '330201005': '东钱湖旅游度假区', '330201002': '宁波大榭开发区',
            '330201001': '宁波杭州湾新区', '330201003': '国家高新区', '330201006': '宁波保税区', '330201004': '保税区',
            '330201007': '梅山保税港区', '330201008': '空港物流', '330203113': '高桥镇', '330203131': '章水镇', '330203004': '月湖街道',
            '330203005': '鼓楼街道', '330203132': '龙观乡', '330203007': '段塘街道', '330203009': '石碶街道', '330203008': '望春街道',
            '330203002': '江厦街道', '330203003': '西门街道', '330203006': '白云街道', '330203001': '南门街道', '330203119': '鄞江镇',
            '330203100': '高桥镇', '330203114': '横街镇', '330203101': '横街镇', '330203115': '集士港镇', '330203102': '集士港镇',
            '330203116': '古林镇', '330203103': '古林镇', '330203118': '洞桥镇', '330203104': '洞桥镇', '330203105': '鄞江镇',
            '330203106': '章水镇', '330203200': '龙观乡', '330205103': '慈城镇', '330205008': '前江街道', '330205005': '甬江街道',
            '330205006': '庄桥街道', '330205002': '白沙街道', '330205003': '孔浦街道', '330205004': '文教街道', '330205007': '洪塘街道',
            '330205001': '外滩街道', '330206003': '小港街道', '330206401': '保税区', '330206004': '大碶街道', '330206005': '霞浦街道',
            '330206010': '郭巨街道', '330206002': '新碶街道', '330206001': '大榭街道', '330206007': '戚家山街道', '330206006': '柴桥街道',
            '330206201': '梅山街道', '330206107': '春晓街道', '330206008': '春晓街道', '330206009': '梅山街道', '330206105': '白峰街道',
            '330206011': '白峰街道', '330211101': '九龙湖镇', '330211100': '澥浦镇', '330211005': '贵驷街道', '330211001': '招宝山街道',
            '330211003': '骆驼街道', '330211002': '蛟川街道', '330211004': '庄市街道', '330212102': '塘溪镇', '330212013': '福明街道',
            '330212105': '五乡镇', '330212103': '东钱湖镇', '330212004': '梅墟街道', '330212110': '姜山镇', '330212100': '瞻岐镇',
            '330212002': '钟公庙街道', '330212009': '东胜街道', '330212011': '东柳街道', '330212003': '明楼街道', '330212109': '横溪镇',
            '330212008': '百丈街道', '330212101': '咸祥镇', '330212001': '下应街道', '330212010': '白鹤街道', '330212007': '潘火街道',
            '330212012': '东郊街道', '330212104': '东吴镇', '330212108': '云龙镇', '330212006': '首南街道', '330212106': '邱隘镇',
            '330212134': '瞻岐镇', '330212133': '姜山镇', '330212014': '福明街道', '330212015': '新明街道', '330212016': '聚贤街道',
            '330212005': '中河街道', '330225202': '黄避岙乡', '330225108': '涂茨镇', '330225204': '高塘岛乡', '330225105': '墙头镇',
            '330225200': '东陈乡', '330225101': '石浦镇', '330225002': '丹西街道', '330225205': '新桥镇', '330225206': '东陈乡',
            '330225107': '定塘镇', '330225003': '爵溪街道', '330225201': '晓塘乡', '330225104': '贤庠镇', '330225106': '泗洲头镇',
            '330225203': '茅洋乡', '330225001': '丹东街道', '330225102': '西周镇', '330225103': '鹤浦镇', '330225109': '大徐镇',
            '330225110': '新桥镇', '330226102': '力洋镇', '330226001': '跃龙街道', '330226110': '强蛟镇', '330226201': '茶院乡',
            '330226003': '梅林街道', '330226200': '胡陈乡', '330226004': '桥头胡街道', '330226107': '桑洲镇', '330226109': '大佳何镇',
            '330226112': '深甽镇', '330226105': '岔路镇', '330226211': '胡陈乡', '330226212': '强蛟镇', '330226101': '长街镇',
            '330226202': '越溪乡', '330226002': '桃源街道', '330226108': '黄坛镇', '330226104': '一市镇', '330226111': '西店镇',
            '330226106': '前童镇', '330230100': '大榭街道', '330231100': '庵东镇', '330232100': '新明街道办事处', '330232200': '梅墟街道办事处',
            '330232300': '聚贤街道', '330233100': '东钱湖镇', '330281112': '大隐镇', '330281002': '凤山街道', '330281004': '阳明街道',
            '330281102': '小曹娥镇', '330281108': '牟山镇', '330281115': '大岚镇', '330281110': '三七市镇', '330281001': '梨洲街道',
            '330281005': '低塘街道', '330281106': '马渚镇', '330281111': '河姆渡镇', '330281114': '梁弄镇', '330281103': '泗门镇',
            '330281006': '朗霞街道', '330281109': '丈亭镇', '330281201': '鹿亭乡', '330281101': '黄家埠镇', '330281116': '四明山镇',
            '330281132': '三七市镇', '330281003': '兰江街道', '330281113': '陆埠镇', '330281107': '余姚市经济开发区', '330281100': '临山镇',
            '330281131': '临山镇', '330282109': '桥头镇', '330282118': '庵东镇', '330282107': '观海卫镇', '330282005': '白沙路街道',
            '330282113': '胜山镇', '330282110': '匡堰镇', '330282120': '长河镇', '330282121': '周巷镇', '330282123': '龙山镇',
            '330282402': '慈东工业区', '330282104': '掌起镇', '330282003': '坎墩街道', '330282114': '横河镇', '330282006': '古塘街道',
            '330282401': '慈溪市林场', '330282004': '浒山街道', '330282002': '宗汉街道', '330282108': '附海镇', '330282111': '逍林镇',
            '330282112': '新浦镇', '330282116': '崇寿镇', '330283108': '松岙镇', '330283001': '锦屏街道', '330283106': '裘村镇',
            '330283100': '溪口镇', '330283003': '江口街道', '330283004': '西坞街道', '330283107': '大堰镇', '330283002': '岳林街道',
            '330283104': '莼湖街道', '330283103': '尚田街道', '330283105': '方桥街道', '330283005': '萧王庙街道', '330302115': '大南街道',
            '330302113': '南郊街道', '330302114': '丰门街道', '330302117': '山福镇', '330302102': '藤桥镇', '330302023': '七都街道',
            '330302028': '仰义街道', '330302006': '五马街道', '330302024': '滨江街道', '330302027': '双屿街道', '330302025': '南汇街道',
            '330302026': '松台街道', '330302029': '大南街道', '330302112': '蒲鞋市街道', '330302030': '蒲鞋市街道', '330302031': '南郊街道',
            '330302116': '广化街道', '330302032': '广化街道', '330302033': '丰门街道', '330302105': '山福镇', '330303002': '蒲州街道',
            '330303004': '永兴街道', '330303006': '状元街道', '330303007': '瑶溪街道', '330303003': '海滨街道', '330303001': '永中街道',
            '330304111': '潘桥街道', '330304001': '景山街道', '330304005': '娄桥街道', '330304007': '三垟街道', '330304108': '泽雅镇',
            '330304006': '新桥街道', '330304012': '仙岩街道', '330304011': '丽岙街道', '330304008': '瞿溪街道', '330304002': '梧田街道',
            '330304003': '南白象街道', '330304009': '郭溪街道', '330304010': '潘桥街道', '330304004': '茶山街道', '330305003': '东屏街道',
            '330305004': '元觉街道', '330305005': '霓屿街道', '330305001': '北岙街道', '330305101': '大门镇', '330305202': '鹿西乡',
            '330305002': '灵昆街道', '330305006': '昆鹏街道', '330311001': '灵昆街道', '330311002': '鲲鹏街道', '330321011': '星海街道',
            '330321008': '沙城街道', '330321009': '天河街道', '330321005': '海城街道', '330324108': '岩头镇', '330324005': '东瓯街道',
            '330324002': '北城街道', '330324228': '溪下乡', '330324120': '金溪镇', '330324124': '溪下乡', '330324125': '界坑乡',
            '330324008': '乌牛街道', '330324102': '桥头镇', '330324104': '桥下镇', '330324107': '巽宅镇', '330324006': '三江商务区（三江街道）',
            '330324402': '正江山林场', '330324003': '南城街道', '330324112': '鹤盛镇', '330324106': '碧莲镇', '330324109': '枫林镇',
            '330324111': '沙头镇', '330324001': '东城街道', '330324007': '黄田街道', '330324105': '大若岩镇', '330324401': '四海山林场',
            '330324113': '上塘中心城区管理委员会', '330324114': '瓯北城市新区（瓯北街道）', '330324004': '江北街道', '330324115': '岩坦镇',
            '330324121': '瓯北街道', '330324009': '瓯北街道', '330324110': '岩坦镇', '330324123': '云岭乡', '330324226': '云岭乡',
            '330324122': '茗岙乡', '330324227': '茗岙乡', '330324229': '界坑乡', '330324400': '县特产场场区', '330326113': '怀溪镇',
            '330326106': '南麂镇', '330326111': '闹村乡', '330326101': '鳌江镇', '330326214': '青街乡', '330326109': '南雁镇',
            '330326105': '腾蛟镇', '330326117': '万全镇', '330326107': '山门镇', '330326103': '萧江镇', '330326102': '水头镇',
            '330326108': '顺溪镇', '330326215': '昆阳镇', '330326104': '海西镇', '330326100': '昆阳镇', '330326118': '海西镇',
            '330326119': '南麂镇', '330326112': '麻步镇', '330326120': '麻步镇', '330326110': '凤卧镇', '330326121': '凤卧镇',
            '330326122': '怀溪镇', '330326217': '闹村乡', '330326401': '滨海新区', '330327118': '马站镇', '330327119': '大渔镇',
            '330327120': '炎亭镇', '330327121': '望里镇', '330327122': '莒溪镇', '330327218': '岱岭畲族乡', '330327123': '霞关镇',
            '330327124': '沿浦镇', '330327101': '龙港镇', '330327103': '宜山镇', '330327104': '钱库镇', '330327107': '金乡镇',
            '330327113': '桥墩镇', '330327116': '矾山镇', '330327117': '赤溪镇', '330327216': '凤阳畲族乡', '330327112': '藻溪镇',
            '330327125': '南宋镇', '330327221': '灵溪镇', '330327100': '灵溪镇', '330327126': '南宋镇', '330327127': '霞关镇',
            '330327128': '沿浦镇', '330328110': '铜铃山镇', '330328103': '西坑畲族镇', '330328101': '百丈漈镇', '330328102': '南田镇',
            '330328105': '珊溪镇', '330328107': '玉壶镇', '330328106': '巨屿镇', '330328108': '峃口镇', '330328104': '黄坦镇',
            '330328217': '周山畲族乡', '330328113': '公阳乡', '330328100': '大峃镇', '330328109': '周壤镇', '330328225': '桂山乡',
            '330328226': '双桂乡', '330328227': '平和乡', '330328228': '公阳乡', '330328111': '大峃镇', '330329102': '百丈镇',
            '330329111': '泰顺县南浦溪镇', '330329100': '罗阳镇', '330329230': '泰顺县大安乡', '330329113': '泰顺县西旸镇',
            '330329229': '泰顺县雪溪乡', '330329112': '泰顺县龟湖镇', '330329228': '泰顺县柳峰乡', '330329227': '泰顺县东溪乡',
            '330329225': '泰顺县包垟乡', '330329226': '泰顺县凤垟乡', '330329204': '竹里畲族乡', '330329105': '彭溪镇', '330329107': '仕阳镇',
            '330329101': '司前畲族镇', '330329103': '筱村镇', '330329106': '雅阳镇', '330329104': '泗溪镇', '330329109': '三魁镇',
            '330329400': '乌岩岭自然保护区', '330381040': '平阳坑镇', '330381011': '南滨街道', '330381005': '上望街道', '330381050': '桐浦镇',
            '330381060': '北麂乡', '330381003': '锦湖街道', '330381001': '安阳街道', '330381002': '玉海街道', '330381007': '莘塍街道',
            '330381122': '湖岭镇', '330381008': '汀田街道', '330381009': '飞云街道', '330381101': '塘下镇', '330381004': '东山街道',
            '330381125': '高楼镇', '330381116': '马屿镇', '330381132': '仙降街道', '330381131': '陶山镇', '330381020': '林川镇',
            '330381010': '芳庄乡', '330381126': '桐浦镇', '330381013': '云周街道', '330381120': '陶山镇', '330381127': '林川镇',
            '330381030': '曹村镇', '330381128': '曹村镇', '330381129': '平阳坑镇', '330381221': '芳庄乡', '330381222': '北麂乡',
            '330381070': '潘岱街道', '330381012': '潘岱街道', '330381080': '云周街道', '330382002': '乐成街道办事处', '330382104': '雁荡镇',
            '330382080': '龙西乡', '330382114': '柳市镇', '330382030': '南岳镇', '330382060': '岭底乡', '330382003': '城南街道办事处',
            '330382106': '清江镇', '330382005': '翁垟街道办事处', '330382004': '盐盆街道办事处', '330382001': '城东街道办事处',
            '330382006': '白石街道办事处', '330382102': '仙溪镇', '330382007': '石帆街道办事处', '330382105': '芙蓉镇', '330382108': '虹桥镇',
            '330382111': '淡溪镇', '330382115': '北白象镇', '330382010': '磐石镇', '330382125': '磐石镇', '330382070': '智仁乡',
            '330382210': '智仁乡', '330382211': '龙西乡', '330382212': '岭底乡', '330382101': '大荆镇', '330382008': '天成街道办事处',
            '330382050': '湖雾镇', '330382121': '湖雾镇', '330382040': '南塘镇', '330382122': '南塘镇', '330382123': '南岳镇',
            '330382020': '蒲岐镇', '330382124': '蒲岐镇', '330402014': '长水街道', '330402011': '新兴街道', '330402013': '东栅街道',
            '330402103': '新丰镇', '330402105': '大桥镇', '330402007': '建设街道', '330402104': '七星镇', '330402101': '余新镇',
            '330402008': '解放街道', '330402009': '新嘉街道', '330402131': '凤桥镇', '330402010': '南湖街道', '330402012': '城南街道',
            '330402015': '七星街道', '330402100': '凤桥镇', '330402132': '南湖街道', '330411004': '塘汇街道', '330411104': '新塍镇',
            '330411002': '新城街道', '330411005': '高照街道', '330411105': '王店镇', '330411106': '洪合镇', '330411103': '油车港镇',
            '330411101': '王江泾镇', '330411003': '嘉北街道', '330412002': '城南街道', '330412003': '嘉北街道', '330412004': '塘汇街道',
            '330412001': '长水街道', '330413110': '乍浦镇', '330421001': '魏塘街道', '330421112': '天凝镇', '330421102': '大云镇',
            '330421103': '西塘镇', '330421105': '干窑镇', '330421107': '陶庄镇', '330421111': '姚庄镇', '330421003': '惠民街道',
            '330421002': '罗星街道', '330424102': '百步镇', '330424002': '县开发区（西塘桥街道）', '330424003': '元通街道',
            '330424001': '武原街道', '330424004': '秦山街道', '330424101': '沈荡镇', '330424103': '于城镇', '330424106': '通元镇',
            '330424105': '澉浦镇（南北湖风景区）', '330424005': '望海街道', '330481101': '许村镇', '330481105': '周王庙镇',
            '330481001': '硖石街道', '330481112': '袁花镇', '330481002': '海洲街道', '330481003': '海昌街道', '330481004': '马桥街道',
            '330481106': '丁桥镇', '330481107': '斜桥镇', '330481108': '黄湾镇', '330481103': '长安镇', '330481100': '盐官镇',
            '330481110': '盐官镇', '330482001': '当湖街道', '330482102': '新埭镇', '330482101': '乍浦镇', '330482003': '曹桥街道',
            '330482108': '独山港镇', '330482002': '钟埭街道', '330482103': '新仓镇', '330482107': '林埭镇', '330482106': '广陈镇',
            '330483002': '龙翔街道', '330483001': '梧桐街道', '330483107': '崇福镇', '330483104': '河山镇', '330483003': '凤鸣街道',
            '330483101': '濮院镇', '330483102': '屠甸镇', '330483103': '石门镇', '330483105': '洲泉镇', '330483108': '高桥镇',
            '330483106': '大麻镇', '330483004': '高桥街道', '330483111': '乌镇镇', '330483100': '乌镇镇', '330502132': '湖东街道',
            '330502102': '妙西镇', '330502104': '埭溪镇', '330502105': '东林镇', '330502004': '飞英街道', '330502001': '月河街道',
            '330502005': '龙泉街道', '330502002': '朝阳街道', '330502012': '环渚街道', '330502101': '八里店镇', '330502003': '爱山街道',
            '330502013': '高新区', '330502131': '环渚乡', '330502032': '道场乡', '330502006': '凤凰街道', '330502007': '康山街道',
            '330502008': '仁皇山街道', '330502009': '滨湖街道', '330502010': '龙溪街道', '330502011': '杨家埠街道', '330502031': '织里镇',
            '330502100': '织里镇', '330502200': '道场乡', '330503108': '石淙镇', '330503105': '菱湖镇', '330503101': '双林镇',
            '330503103': '善琏镇', '330503107': '千金镇', '330503106': '和孚镇', '330503104': '旧馆镇', '330503102': '练市镇',
            '330503131': '南浔镇', '330503001': '东迁街道', '330503100': '南浔镇', '330503002': '旧馆街道', '330521114': '新安镇',
            '330521101': '乾元镇', '330521102': '新市镇', '330521104': '钟管镇', '330521103': '洛舍镇', '330521202': '三合乡',
            '330521113': '禹越镇', '330521201': '筏头乡', '330521105': '莫干山镇', '330521132': '武康镇', '330521004': '下渚湖街道',
            '330521001': '武康街道', '330521003': '阜溪街道', '330521005': '康乾街道', '330521131': '雷甸镇', '330521110': '雷甸镇',
            '330521115': '莫干山镇', '330521002': '舞阳街道', '330522210': '南太湖产业集聚区', '330522101': '洪桥镇', '330522108': '小浦镇',
            '330522204': '白岘乡', '330522205': '槐坎乡', '330522103': '夹浦镇', '330522001': '雉城街道', '330522002': '画溪街道',
            '330522202': '吕山乡', '330522003': '太湖街道', '330522102': '李家巷镇', '330522104': '林城镇', '330522106': '虹星桥镇',
            '330522111': '泗安镇', '330522131': '长兴县太湖度假区', '330522208': '龙山新区', '330522209': '长兴县经济技术开发区',
            '330522109': '煤山镇', '330522207': '水口乡', '330522004': '龙山街道', '330522121': '和平镇', '330522110': '和平镇',
            '330522112': '煤山镇', '330522200': '水口乡', '330523111': '天子湖镇', '330523103': '鄣吴镇', '330523104': '杭垓镇',
            '330523105': '孝丰镇', '330523106': '报福镇', '330523108': '天荒坪镇', '330523205': '上墅乡', '330523122': '昌硕街道',
            '330523121': '灵峰街道', '330523204': '孝源街道', '330523107': '章村镇', '330523206': '山川乡', '330523201': '溪龙乡',
            '330523132': '递铺街道', '330523131': '梅溪镇', '330523001': '递铺街道', '330523003': '灵峰街道', '330523004': '孝源街道',
            '330523110': '梅溪镇', '330523002': '昌硕街道', '330585007': '康山街道', '330585006': '凤凰街道', '330585008': '杨家埠街道',
            '330585131': '龙溪街道', '330585001': '仁皇山街道办事处', '330585002': '滨湖街道办事处', '330602008': '东湖街道',
            '330602015': '孙端街道', '330602108': '富盛镇', '330602012': '越城区斗门街道', '330602112': '东湖镇', '330602113': '皋埠镇',
            '330602115': '陶堰镇', '330602107': '越城区孙端镇', '330602105': '越城区马山镇', '330602002': '府山街道', '330602004': '北海街道',
            '330602103': '鉴湖镇', '330602001': '塔山街道', '330602005': '城南街道', '330602101': '灵芝镇', '330602102': '东浦镇',
            '330602003': '蕺山街道', '330602119': '马山街道', '330602110': '迪荡街道', '330602117': '孙端街道', '330602116': '沥海街道',
            '330602114': '富盛镇', '330602017': '沥海街道', '330602111': '稽山街道', '330602006': '稽山街道', '330602007': '迪荡街道',
            '330602010': '东浦街道', '330602011': '鉴湖街道', '330602013': '皋埠街道', '330602014': '马山街道', '330602016': '陶堰街道',
            '330602009': '灵芝街道', '330603010': '杨汛桥街道', '330603107': '王坛镇', '330603109': '稽东镇', '330603106': '安昌镇',
            '330603004': '湖塘街道', '330603001': '柯桥街道', '330603101': '钱清镇', '330603108': '兰亭镇', '330603111': '漓渚镇',
            '330603114': '夏履镇', '330603002': '柯岩街道', '330603003': '华舍街道', '330603136': '杨汛桥镇', '330603103': '福全镇',
            '330603131': '滨海工业区', '330603132': '旅游度假区', '330603133': '平水新城', '330603134': '齐贤镇', '330603005': '齐贤街道',
            '330603007': '安昌街道', '330603008': '兰亭街道', '330603009': '钱清街道', '330603011': '马鞍街道', '330603105': '平水镇',
            '330603006': '福全街道', '330604004': '道墟街道', '330604133': '小越镇', '330604003': '东关街道', '330604101': '长塘镇',
            '330604108': '梁湖镇', '330604201': '陈溪乡', '330604113': '崧厦镇', '330604002': '曹娥街道', '330604102': '上浦镇',
            '330604105': '下管镇', '330604104': '章镇镇', '330604106': '丰惠镇', '330604107': '永和镇', '330604111': '谢塘镇',
            '330604112': '盖北镇', '330604109': '驿亭镇', '330604001': '百官街道', '330604103': '汤浦镇', '330604202': '丁宅乡',
            '330604131': '道墟镇', '330604005': '梁湖街道', '330604006': '小越街道', '330604007': '崧厦街道', '330604200': '岭南乡',
            '330604132': '岭南乡', '330624109': '镜岭镇', '330624203': '双彩乡', '330624002': '南明街道', '330624102': '梅渚镇',
            '330624206': '巧英乡', '330624205': '新林乡', '330624201': '东茗乡', '330624001': '羽林街道', '330624003': '七星街道',
            '330624101': '澄潭镇', '330624104': '回山镇', '330624107': '小将镇', '330624106': '大市聚镇', '330624108': '沙溪镇',
            '330624132': '城南乡', '330624131': '儒岙镇', '330624004': '澄潭街道', '330624110': '儒岙镇', '330624112': '沃洲镇',
            '330624200': '城南乡', '330681110': '赵家镇', '330681120': '陈宅镇', '330681105': '阮市镇', '330681118': '街亭镇',
            '330681109': '枫桥镇', '330681104': '店口镇', '330681111': '马剑镇', '330681108': '山下湖镇', '330681119': '璜山镇',
            '330681121': '岭北镇', '330681132': '陈宅镇', '330681122': '浬浦镇', '330681201': '东和乡', '330681113': '草塔镇',
            '330681114': '王家井镇', '330681002': '浣东街道', '330681112': '五泄镇', '330681001': '暨阳街道', '330681102': '应店街镇',
            '330681103': '次坞镇', '330681116': '同山镇', '330681003': '陶朱街道', '330681117': '安华镇', '330681101': '大唐镇',
            '330681124': '东白湖镇', '330681106': '直埠镇', '330681115': '牌头镇', '330681107': '姚江镇', '330681004': '暨南街道',
            '330681131': '赵家镇', '330681005': '大唐街道', '330683002': '三江街道', '330683106': '谷来镇', '330683109': '北漳镇',
            '330683201': '里南乡', '330683202': '竹溪乡', '330683101': '长乐镇', '330683108': '金庭镇', '330683204': '王院乡',
            '330683003': '鹿山街道', '330683104': '三界镇', '330683103': '黄泽镇', '330683102': '崇仁镇', '330683205': '通源乡',
            '330683107': '仙岩镇', '330683203': '雅璜乡', '330683105': '石璜镇', '330683001': '剡湖街道', '330683004': '浦口街道',
            '330683131': '甘霖镇', '330683132': '下王镇', '330683133': '贵门乡', '330683005': '浦口街道', '330683110': '下王镇',
            '330683100': '甘霖镇', '330683200': '贵门乡', '330702102': '安地镇', '330702001': '城东街道', '330702003': '城西街道',
            '330702004': '城北街道', '330702103': '白龙桥镇', '330702104': '琅琊镇', '330702105': '蒋堂镇', '330702202': '竹马乡',
            '330702204': '箬阳乡', '330702207': '岭上乡', '330702009': '新狮街道', '330702101': '雅畈镇', '330702206': '塔石乡',
            '330702002': '城中街道', '330702205': '沙畈乡', '330702203': '长山乡', '330702208': '莘畈乡', '330702201': '乾西乡',
            '330702100': '罗店镇', '330702005': '江南街道', '330702006': '三江街道', '330702007': '西关街道', '330702008': '秋滨街道',
            '330702106': '汤溪镇', '330702107': '罗埠镇', '330702108': '洋埠镇', '330702209': '苏孟乡', '330703112': '鞋塘办事处',
            '330703001': '多湖街道', '330703002': '东孝街道', '330703107': '塘雅镇', '330703103': '曹宅镇', '330703104': '澧浦镇',
            '330703106': '江东镇', '330703105': '岭下镇', '330703101': '孝顺镇', '330703108': '赤松镇', '330703102': '傅村镇',
            '330703111': '源东乡', '330703200': '源东乡', '330723003': '熟溪街道', '330723001': '白洋街道', '330723002': '壶山街道',
            '330723101': '履坦镇', '330723103': '泉溪镇', '330723105': '王宅镇', '330723107': '茭道镇', '330723201': '白姆乡',
            '330723202': '俞源乡', '330723102': '桐琴镇', '330723203': '坦洪乡', '330723204': '西联乡', '330723106': '桃溪镇',
            '330723205': '三港乡', '330723104': '新宅镇', '330723206': '大溪口乡', '330723108': '畲族镇', '330723100': '柳城畲族镇',
            '330723131': '大田乡', '330723200': '大田乡', '330726003': '浦阳街道', '330726103': '郑家坞镇', '330726104': '郑宅镇',
            '330726102': '白马镇', '330726201': '中余乡', '330726001': '浦南街道', '330726002': '仙华街道', '330726106': '檀溪镇',
            '330726203': '花桥乡', '330726105': '岩头镇', '330726204': '虞宅乡', '330726202': '前吴乡', '330726101': '黄宅镇',
            '330726107': '杭坪镇', '330726111': '大畈乡', '330726200': '大畈乡', '330727206': '盘峰乡', '330727109': '尖山镇',
            '330727207': '高二乡', '330727123': '万苍乡', '330727103': '仁川镇', '330727209': '胡宅乡', '330727105': '方前镇',
            '330727201': '双峰乡', '330727205': '窈川乡', '330727208': '维新乡', '330727108': '冷水镇', '330727107': '尚湖镇',
            '330727121': '安文街道', '330727101': '新渥街道', '330727102': '尖山镇', '330727106': '玉山镇', '330727104': '大盘镇',
            '330727203': '双溪乡', '330727211': '九和乡', '330727122': '深泽乡', '330727001': '安文街道', '330727002': '新渥街道',
            '330727212': '盘峰乡', '330781112': '横溪镇', '330781102': '游埠镇', '330781203': '水亭畲族乡', '330781104': '诸葛镇',
            '330781106': '黄店镇', '330781109': '马涧镇', '330781111': '梅江镇', '330781004': '永昌街道', '330781002': '云山街道',
            '330781007': '上华街道', '330781005': '赤溪街道', '330781001': '兰江街道', '330781006': '女埠街道', '330781108': '香溪镇',
            '330781209': '柏社乡', '330781121': '灵洞乡', '330781200': '灵洞乡', '330782003': '稠江街道', '330782006': '城西街道',
            '330782106': '大陈镇', '330782002': '江东街道', '330782104': '上溪镇', '330782001': '稠城街道', '330782105': '苏溪镇',
            '330782112': '福田街道', '330782101': '赤岸镇', '330782102': '义亭镇', '330782004': '北苑街道', '330782005': '后宅街道',
            '330782007': '廿三里街道', '330782111': '佛堂镇', '330782008': '福田街道', '330782100': '佛堂镇', '330783006': '城东街道',
            '330783108': '歌山镇', '330783114': '马宅镇', '330783118': '南马镇', '330783122': '画水镇', '330783123': '横店镇',
            '330783003': '南市街道', '330783005': '江北街道', '330783109': '佐村镇', '330783001': '吴宁街道', '330783201': '三单乡',
            '330783007': '六石街道', '330783107': '虎鹿镇', '330783112': '湖溪镇', '330783004': '白云街道', '330783106': '巍山镇',
            '330783116': '千祥镇', '330783121': '东阳江镇', '330783110': '东阳江镇', '330784111': '西溪镇', '330784112': '象珠镇',
            '330784001': '东城街道', '330784002': '西城街道', '330784003': '江南街道', '330784105': '石柱镇', '330784107': '舟山镇',
            '330784108': '古山镇', '330784109': '方岩镇', '330784115': '芝英镇', '330784114': '花街镇', '330784106': '前仓镇',
            '330784113': '唐先镇', '330784121': '龙山镇', '330784110': '龙山镇', '330787001': '江南街道', '330787004': '三江街道',
            '330787006': '汤溪镇', '330787007': '西关街道', '330787008': '洋埠镇', '330787003': '秋滨街道', '330787002': '罗埠镇',
            '330787005': '苏孟乡', '330802008': '信安街道', '330802101': '航埠镇', '330802209': '七里乡', '330802213': '姜家山乡',
            '330802007': '荷花街道', '330802006': '府山街道', '330802434': '双港街道', '330802214': '万田乡', '330802215': '石室乡',
            '330802211': '沟溪乡', '330802010': '新新街道', '330802003': '白云街道', '330802011': '花园街道', '330802131': '石梁镇',
            '330802432': '九华乡', '330802212': '华墅乡', '330802030': '黄家街道', '330802005': '新新街道', '330802009': '白云街道',
            '330802433': '衢化街道', '330802012': '衢化街道', '330802013': '花园街道', '330802100': '石梁镇', '330802205': '黄家乡',
            '330802210': '九华乡', '330803020': '东港街道', '330803103': '莲花镇', '330803112': '廿里镇', '330803113': '湖南镇',
            '330803203': '双桥乡', '330803206': '周家乡', '330803207': '云溪乡', '330803213': '举村乡', '330803218': '岭洋乡',
            '330803219': '黄坛口乡', '330803115': '杜泽镇', '330803001': '樟潭街道', '330803002': '浮石街道', '330803114': '高家镇',
            '330803101': '峡川镇', '330803111': '后溪镇', '330803202': '太真乡', '330803109': '全旺镇', '330803003': '横路乡',
            '330803121': '上方镇', '330803123': '大洲镇', '330803122': '灰坪乡', '330803100': '上方镇', '330803110': '大洲镇',
            '330803200': '灰坪乡', '330822221': '东案乡', '330822001': '天马街道', '330822003': '金川街道', '330822108': '招贤镇',
            '330822115': '辉埠镇', '330822116': '芳村镇', '330822211': '同弓乡', '330822219': '新昌乡', '330822104': '白石镇',
            '330822109': '青石镇', '330822002': '紫港街道', '330822111': '球川镇', '330822213': '大桥头乡', '330822121': '何家乡',
            '330822200': '何家乡', '330824202': '中村乡', '330824107': '杨林镇', '330824109': '齐溪镇', '330824113': '村头镇',
            '330824205': '长虹乡', '330824208': '何田乡', '330824218': '大溪边乡', '330824108': '苏庄镇', '330824217': '音坑乡',
            '330824106': '桐村镇', '330824221': '芹阳镇', '330824216': '林山乡', '330824114': '池淮镇', '330824111': '华埠镇',
            '330824115': '华埠镇', '330824112': '马金镇', '330824116': '马金镇', '330824117': '池淮镇', '330825106': '詹家镇',
            '330825101': '湖镇镇', '330825111': '塔石镇', '330825001': '龙洲街道', '330825201': '罗家乡', '330825209': '社阳乡',
            '330825211': '大街乡', '330825212': '沐尘畲族乡', '330825213': '模环乡', '330825109': '溪口镇', '330825002': '东华街道',
            '330825102': '小南海镇', '330825207': '石佛乡', '330825203': '庙下乡', '330825131': '横山镇', '330825110': '横山镇',
            '330881120': '石门镇', '330881102': '四都镇', '330881104': '清湖镇', '330881105': '坛石镇', '330881113': '长台镇',
            '330881116': '上余镇', '330881201': '大陈乡', '330881121': '贺村镇', '330881203': '碗窑乡', '330881131': '石门镇',
            '330881207': '保安乡', '330881002': '虎山街道', '330881106': '大桥镇', '330881119': '峡口镇', '330881211': '双溪口乡',
            '330881213': '塘源口乡', '330881112': '廿八都镇', '330881109': '新塘边镇', '330881001': '双塔街道', '330881118': '凤林镇',
            '330881212': '张村乡', '330881003': '清湖街道', '330881214': '张村乡', '330902006': '临城街道', '330902003': '环南街道',
            '330902004': '城东街道', '330902105': '干览镇', '330902009': '双桥街道', '330902008': '马岙街道', '330902002': '昌国街道',
            '330902005': '盐仓街道', '330902104': '白泉镇', '330902007': '岑港街道', '330902133': '小沙镇', '330902153': '临城街道',
            '330902131': '金塘镇', '330902010': '小沙街道', '330902050': '千岛街道', '330902100': '金塘镇', '330903105': '东极镇',
            '330903003': '东港街道', '330903005': '展茅街道', '330903001': '沈家门街道', '330903004': '朱家尖街道', '330903104': '桃花镇',
            '330903102': '虾峙镇', '330903106': '普陀山镇', '330903100': '六横镇', '330921100': '高亭镇', '330921200': '秀山乡',
            '330921106': '衢山镇', '330921103': '岱西镇', '330921102': '岱东镇', '330921105': '长涂镇', '330921101': '东沙镇',
            '330922100': '菜园镇', '330922101': '嵊山镇', '330922102': '洋山镇', '330922201': '黄龙乡', '330922203': '花鸟乡',
            '330922202': '枸杞乡', '330922200': '五龙乡', '330998002': '朱家尖街道', '330998001': '普陀山镇', '330999002': '临城街道',
            '330999001': '千岛街道', '331002008': '章安街道', '331002005': '三甲街道', '331002002': '白云街道', '331002003': '葭沚街道',
            '331002001': '海门街道', '331002006': '下陈街道', '331002004': '洪家街道', '331002101': '大陈镇', '331002401': '滨海工业区',
            '331002007': '前所街道', '331002402': '月湖新城', '331002009': '海虹街道', '331002400': '椒江农场', '331003131': '屿头乡',
            '331003101': '宁溪镇', '331003201': '上郑乡', '331003107': '院桥镇', '331003202': '富山乡', '331003203': '茅畲乡',
            '331003204': '上垟乡', '331003004': '北城街道', '331003007': '江口街道', '331003003': '西城街道', '331003005': '新前街道',
            '331003006': '澄江街道', '331003103': '头陀镇', '331003108': '沙埠镇', '331003205': '平田乡', '331003001': '东城街道',
            '331003008': '高桥街道', '331003102': '北洋镇', '331003002': '南城街道', '331003200': '屿头乡', '331004003': '路北街道',
            '331004002': '路桥街道', '331004004': '螺洋街道', '331004005': '桐屿街道', '331004104': '横街镇', '331004103': '新桥镇',
            '331004107': '蓬街镇', '331004001': '路南街道', '331004106': '金清镇', '331004006': '峰江街道', '331004401': '滨海新区',
            '331004400': '滨海工业城', '331021002': '坎门街道', '331021003': '大麦屿街道', '331021201': '鸡山乡', '331021001': '玉城街道',
            '331021106': '芦浦镇', '331021105': '沙门镇', '331021202': '海山乡', '331021102': '楚门镇', '331021103': '干江镇',
            '331021101': '清港镇', '331021005': '浙江省台州市玉环市经济开发区', '331021004': '龙溪镇', '331022003': '沙柳街道',
            '331022102': '珠岙镇', '331022103': '亭旁镇', '331022106': '横渡镇', '331022105': '健跳镇', '331022108': '花桥镇',
            '331022205': '蛇蟠乡', '331022101': '沙柳街道', '331022133': '浦坝港镇', '331022131': '海游街道', '331022001': '海游街道',
            '331022132': '海润街道', '331022002': '海润街道', '331022107': '浦坝港镇', '331023104': '街头镇', '331023105': '平桥镇',
            '331023002': '始丰街道', '331023106': '坦头镇', '331023107': '三合镇', '331023001': '赤城街道', '331023108': '洪畴镇',
            '331023203': '龙溪乡', '331023204': '雷峰乡', '331023207': '南屏乡', '331023209': '泳溪乡', '331023101': '白鹤镇',
            '331023003': '福溪街道', '331023102': '石梁镇', '331023109': '三州乡', '331023200': '三州乡', '331024206': '步路乡',
            '331024207': '广度乡', '331024102': '埠头镇', '331024202': '湫山乡', '331024101': '横溪镇', '331024203': '淡竹乡',
            '331024205': '上张乡', '331024201': '溪港乡', '331024204': '皤滩乡', '331024105': '官路镇', '331024103': '白塔镇',
            '331024104': '田市镇', '331024001': '安洲街道', '331024002': '南峰街道', '331024003': '福应街道', '331024107': '朱溪镇',
            '331024106': '下各镇', '331024209': '大战乡', '331024112': '双庙乡', '331024113': '台州市仙居县经济开发区',
            '331024114': '仙居县西区', '331024115': '朱溪水库', '331024116': '新区', '331024111': '安岭乡', '331024200': '安岭乡',
            '331024210': '双庙乡', '331042005': '三甲街道', '331042009': '海虹街道', '331081104': '新河镇', '331081105': '石塘镇',
            '331081106': '滨海镇', '331081107': '温峤镇', '331081108': '城南镇', '331081109': '石桥头镇', '331081003': '城西街道',
            '331081002': '城东街道', '331081001': '太平街道', '331081102': '松门镇', '331081005': '横峰街道', '331081101': '大溪镇',
            '331081103': '箬横镇', '331081004': '城北街道', '331081132': '产业集聚区', '331081133': '市工业园区管委会', '331081131': '泽国镇',
            '331081632': '坞根镇', '331081100': '泽国镇', '331081110': '坞根镇', '331081400': '东部新区', '331082002': '大洋街道',
            '331082003': '江南街道', '331082005': '邵家渡街道', '331082101': '东塍镇', '331082114': '桃渚镇', '331082111': '沿江镇',
            '331082113': '上盘镇', '331082004': '大田街道', '331082106': '白水洋镇', '331082107': '括苍镇', '331082001': '古城街道',
            '331082108': '永丰镇', '331082109': '尤溪镇', '331082105': '河头镇', '331082103': '汇溪镇', '331082112': '杜桥镇',
            '331082104': '小芝镇', '331082132': '汛桥镇', '331082131': '涌泉镇', '331082100': '汛桥镇', '331082110': '涌泉镇',
            '331101210': '南明山街道', '331102103': '老竹畲族镇', '331102201': '仙渡乡', '331102001': '紫金街道办事处',
            '331102002': '岩泉街道办事处', '331102206': '黄村乡', '331102104': '雅溪镇', '331102202': '峰源乡', '331102007': '联城街道办事处',
            '331102003': '万象街道办事处', '331102102': '大港头镇', '331102204': '丽新畲族乡', '331102004': '白云街道办事处',
            '331102131': '碧湖镇', '331102132': '太平乡', '331102008': '南明山街道', '331102100': '碧湖镇', '331102200': '太平乡',
            '331121219': '阜山乡', '331121102': '东源镇', '331121103': '高湖镇', '331121104': '船寮镇', '331121109': '仁庄镇',
            '331121204': '海溪乡', '331121201': '黄垟乡', '331121213': '汤垟乡', '331121101': '温溪镇', '331121205': '章村乡',
            '331121001': '鹤城街道', '331121208': '舒桥乡', '331121105': '海口镇', '331121106': '腊口镇', '331121107': '北山镇',
            '331121202': '季宅乡', '331121002': '瓯南街道', '331121203': '高市乡', '331121206': '祯旺乡', '331121209': '巨浦乡',
            '331121211': '万阜乡', '331121216': '吴坑乡', '331121218': '章旦乡', '331121003': '油竹街道', '331121217': '仁宫乡',
            '331121215': '小舟山乡', '331121108': '山口镇', '331121214': '贵岙乡', '331121212': '方山乡', '331121207': '祯埠镇',
            '331121132': '万山乡', '331121131': '三溪口街道', '331121004': '三溪口街道', '331121110': '祯埠镇', '331121200': '万山乡',
            '331122121': '胡源乡', '331122102': '新建镇', '331122103': '舒洪镇', '331122106': '东渡镇', '331122206': '前路乡',
            '331122207': '三溪乡', '331122212': '石笕乡', '331122002': '新碧街道办事处', '331122001': '五云街道办事处', '331122101': '壶镇镇',
            '331122107': '东方镇', '331122211': '方溪乡', '331122105': '大洋镇', '331122209': '双溪口乡', '331122003': '仙都街道办事处',
            '331122208': '溶江乡', '331122108': '大源镇', '331122203': '七里乡', '331122210': '胡源乡', '331123001': '妙高街道',
            '331123102': '新路湾镇', '331123106': '石练镇', '331123107': '王村口镇', '331123204': '湖山乡', '331123205': '蔡源乡',
            '331123206': '焦滩乡', '331123207': '龙洋乡', '331123209': '西畈乡', '331123104': '金竹镇', '331123203': '高坪乡',
            '331123002': '云峰街道', '331123105': '大柘镇', '331123202': '应村乡', '331123208': '柘岱口乡', '331123103': '北界镇',
            '331123201': '濂竹乡', '331123108': '黄沙腰镇', '331123132': '三仁乡', '331123131': '垵口乡', '331123200': '三仁畲族乡',
            '331123210': '垵口乡', '331124002': '水南街道', '331124101': '古市镇', '331124104': '大东坝镇', '331124202': '斋坛乡',
            '331124203': '三都乡', '331124204': '竹源乡', '331124205': '四都乡', '331124003': '望松街道办事处', '331124206': '赤寿乡',
            '331124211': '枫坪乡人民政府', '331124212': '板桥畲族乡人民政府', '331124213': '裕溪乡人民政府', '331124214': '安民乡',
            '331124201': '叶村乡', '331124102': '玉岩镇人民政府', '331124105': '新兴镇', '331124208': '樟溪乡', '331124001': '西屏街道办事处',
            '331124103': '象溪镇', '331125202': '安溪畲族乡', '331125001': '浮云街道', '331125002': '元和街道', '331125003': '白龙山街道',
            '331125004': '凤凰山街道', '331125105': '崇头镇', '331125106': '石塘镇', '331125107': '紧水滩镇', '331125201': '雾溪畲族乡',
            '331125206': '赤石乡', '331126105': '左溪镇', '331126107': '百山祖镇', '331126205': '隆宫乡', '331126106': '贤良镇',
            '331126002': '濛洲街道', '331126001': '松源街道', '331126206': '举水乡', '331126207': '江根乡', '331126209': '龙溪乡',
            '331126211': '官塘乡', '331126204': '张村乡', '331126101': '黄田镇', '331126003': '屏都街道', '331126102': '竹口镇',
            '331126203': '安南乡', '331126104': '荷地镇', '331126201': '五大堡乡', '331126202': '淤上乡', '331126131': '岭头乡',
            '331126200': '岭头乡', '331127217': '大地乡', '331127218': '家地乡', '331127001': '红星街道办事处', '331127213': '梧桐乡',
            '331127219': '九龙乡', '331127215': '毛垟乡', '331127212': '鸬鹚乡', '331127214': '标溪乡', '331127216': '秋炉乡',
            '331127002': '鹤溪街道办事处', '331127102': '东坑镇', '331127103': '英川镇', '331127203': '梅岐乡', '331127101': '渤海镇',
            '331127208': '大漈乡', '331127202': '澄照乡', '331127201': '大均乡', '331127205': '郑坑乡', '331127104': '沙湾镇',
            '331127209': '景南乡', '331127131': '雁溪乡', '331127210': '雁溪乡', '331181004': '石达石街道', '331181101': '上垟镇',
            '331181102': '小梅镇', '331181103': '查田镇', '331181206': '城北乡', '331181105': '锦溪镇', '331181106': '住龙镇',
            '331181002': '西街街道', '331181204': '道太乡', '331181001': '龙渊街道', '331181104': '安仁镇', '331181107': '屏南镇',
            '331181203': '竹垟畲族乡', '331181205': '岩樟乡', '331181207': '龙南乡', '331181003': '剑池街道', '331181202': '宝溪乡',
            '331181111': '八都镇', '331181131': '兰巨乡', '331181100': '八都镇', '331181200': '兰巨乡'}

def encode_md5(value):
    if value:
        hl = hashlib.md5()
        hl.update(value.encode(encoding='utf-8'))
        return hl.hexdigest()
    return ''

class ZjzwfuSpider(scrapy.Spider):
    name = 'zjzwfu'
    start_urls = [
        "https://zxts.zjzwfw.gov.cn/service/api/xfpt/public/list",
        # "https://zxts.zjzwfw.gov.cn/service/api/xfpt/public/detail?storeId=1580776914846924801"
    ]
    code_dict = {'330102': '上城区', '330105': '拱墅区', '330106': '西湖区', '330108': '滨江区', '330109': '萧山区', '330110': '余杭区',
                 '330111': '富阳区', '330112': '临安区', '330113': '临平区', '330114': '钱塘区', '330122': '桐庐县', '330127': '淳安县',
                 '330182': '建德市', '330198': '杭州西湖风景名胜区', '330201': '市辖区', '330203': '海曙区', '330205': '江北区',
                 '330206': '北仑区', '330211': '镇海区', '330212': '鄞州区', '330225': '象山县', '330226': '宁海县', '330230': '大榭开发区',
                 '330231': '前湾新区', '330232': '高新区', '330233': '东钱湖旅游度假区', '330281': '余姚市', '330282': '慈溪市',
                 '330283': '奉化区', '330302': '鹿城区', '330303': '龙湾区', '330304': '瓯海区', '330305': '洞头区', '330311': '瓯江口',
                 '330321': '温州经济技术开发区', '330324': '永嘉县', '330326': '平阳县', '330327': '苍南县', '330328': '文成县',
                 '330329': '泰顺县', '330330': '龙港市', '330381': '瑞安市', '330382': '乐清市', '330402': '南湖区', '330411': '秀洲区',
                 '330412': '经济技术开发区（国际商务区）', '330413': '嘉兴港区', '330421': '嘉善县', '330424': '海盐县', '330481': '海宁市',
                 '330482': '平湖市', '330483': '桐乡市', '330502': '吴兴区', '330503': '南浔区', '330521': '德清县', '330522': '长兴县',
                 '330523': '安吉县', '330585': '南太湖新区', '330602': '越城区', '330603': '柯桥区', '330604': '上虞区', '330624': '新昌县',
                 '330681': '诸暨市', '330683': '嵊州市', '330702': '婺城区', '330703': '金东区', '330723': '武义县', '330726': '浦江县',
                 '330727': '磐安县', '330781': '兰溪市', '330782': '义乌市', '330783': '东阳市', '330784': '永康市',
                 '330787': '金华市经济技术开发区', '330802': '柯城区', '330803': '衢江区', '330804': '智造新城', '330820': '智慧新城',
                 '330822': '常山县', '330824': '开化县', '330825': '龙游县', '330881': '江山市', '330902': '定海区', '330903': '普陀区',
                 '330921': '岱山县', '330922': '嵊泗县', '330966': '舟山群岛新区海洋产业集聚区', '330996': '六横管委会', '330997': '金塘管委会',
                 '330998': '浙江省舟山群岛新区普陀山朱家尖管委会', '330999': '新城管委会', '331002': '椒江区', '331003': '黄岩区', '331004': '路桥区',
                 '331021': '玉环市', '331022': '三门县', '331023': '天台县', '331024': '仙居县', '331041': '台州市经济开发区',
                 '331042': '台州湾集聚区', '331081': '温岭市', '331082': '临海市', '331101': '丽水市开发区', '331102': '莲都区',
                 '331121': '青田县', '331122': '缙云县', '331123': '遂昌县', '331124': '松阳县', '331125': '云和县', '331126': '庆元县',
                 '331127': '景宁县', '331181': '龙泉市'}
    def start_requests(self):
        data = {
            "pageSize": '10',
            "pageNum": '1',
            "bt": "",
            "bldw": "",
            "startTime": "",
            "endTime": "",
            "wtsdxzqhdm": "",
            "xfmd": "98",
            "xfxs": "",
            "code": "33"
        }
        for code in self.code_dict.keys():
            name = self.code_dict.get(code)
            data['code'] = code
            for url in self.start_urls:
                # if url =="https://zxts.zjzwfw.gov.cn/service/api/xfpt/public/detail?storeId=1580776914846924801":
                #     yield scrapy.Request(url=url,callback=self.parse)
                logging.info(f"url:{url}")
                yield scrapy.Request(url=url,
                                     method="POST",
                                     body=json.dumps(data),
                                     # callback=self.get_parse,
                                     callback=self.get_pages_parse,
                                     meta={
                                         "data":copy.deepcopy(data),
                                         "city_name":copy.deepcopy(name)
                                        }
                                     )

    def get_parse(self, response):
        print(response.meta)
        text = response.body.decode("utf-8")
        print(text)

    def get_pages_parse(self, response):
        logging.info(f"get_pages_parse start")
        text = response.body.decode("utf-8")
        formdata = response.meta["data"]
        resp_url = response.url
        json_s = json.loads(text)
        city_name = response.meta['city_name']
        totalItem = int(json_s['data']['totalItem'])
        pageSize = int(formdata["pageSize"])
        max_page = int(totalItem/pageSize)+1
        if max_page >= 1000:
            max_page = 1000
        # for index in range(9,int(totalItem/pageSize)+2):
        for index in range(1, max_page + 1):
            # if index <= 200:
            #     continue
            formdata["pageNum"] = str(index)
            logging.info(formdata)
            yield scrapy.Request(
                url=resp_url,
                dont_filter=True,
                method="POST",
                body=json.dumps(formdata),
                callback=self.get_storeid,
                meta={"city_name":copy.deepcopy(city_name)}
            )
            # break
            # if index > 1000:
            #     break

    def get_storeid(self, response):
        item = ZjzwfwQuestionItem()
        city_name = response.meta['city_name']
        text = response.body.decode("utf-8")
        json_s = json.loads(text)
        data_list = json_s['data']['list']
        logging.info(f"data_list:{data_list}")
        for data_item in data_list:
            storeid = data_item['storeid']
            item['storeid'] = storeid
            item['city'] = city_name
            item['province'] = "浙江省"
            item['uq_id'] = encode_md5(storeid)
            item['state'] = data_item['xfjclzt']
            item['goal'] = data_item['xfmd']
            url = f"https://zxts.zjzwfw.gov.cn/service/api/xfpt/public/detail?storeId={storeid}"
            logging.info(url)
            yield scrapy.Request(
                url=url,
                # dont_filter=True,
                callback=self.get_detail,
                meta={"item":copy.deepcopy(item)}
            )

    def get_detail(self, response):
        item = response.meta['item']
        text = response.body.decode("utf-8")
        json_s = json.loads(text)
        item['quest_title'] = json_s['data']['bt']
        item['question'] = json_s['data']['nr']
        item['answer'] = json_s['data']['dfyj']
        item['ans_person'] = json_s['data']['dfdw']
        # item['quest_source'] = json_s['data']['sjly']
        item['pubDate'] = json_s['data']['dfsj'][:10]
        item['quest_source'] = "浙江政务服务网"
        logging.info(item)
        yield item

